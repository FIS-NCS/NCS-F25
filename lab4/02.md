# Monitor an Endpoint

Follow the steps to install Wazuh agent (a daemon process) to continuously monitor the terminal environment.

1. Install the agent, pre-configured with the endpoint name and address of the manager to contact

    ```bash
    wget https://packages.wazuh.com/4.x/apt/pool/main/w/wazuh-agent/wazuh-agent_4.14.0-1_amd64.deb && \
     sudo WAZUH_MANAGER='wazuh.manager' WAZUH_AGENT_NAME='Linux' dpkg -i ./wazuh-agent_4.14.0-1_amd64.deb
    ```

1. Start the agent

    ```bash
    sudo service wazuh-agent start
    ```

1. Refresh the dashboard, you should see the monitored hosts at "Endpoints" section.

## Exercise 1: Vulnerability Detection and SCA

- What is the difference between authenticated and unauthenticated vulnerability scans? Why both types need to be performed periodically?
- Show detected vulnerabilities on the monitored endpoint. Explain whether the results indicate that Wazuh performed an authenticated or an unauthenticated scan.
- What is SCA? Show and explain the relevant scans carried out by Wazuh's SCA module against the monitored endpoint.

## Exercise 2: File Integrity Monitoring

> Goal: monitor a directory and alert on file-related events (creation, modification, and deletion)

1. Configure Wazuh's File Integrity Monitoring (FIM) to audit a directory of your choice.
1. Create a text file in the monitored directory then wait for 5 seconds.
1. Add content to the text file and save it. Wait for 5 seconds.
1. Delete the text file from the monitored directory.
1. Show relevant events (triggered rules) in the dashboard.

## Exercise 3: Active Response

> Goal: simulate, detect, and block a brute-force attack against SSH server.

1. Install an SSH server in the terminal environment and verify it works.
1. Configure Wazuh's active response to block an attacker's IP when a brute force attempt is detected.
1. Launch a brute force attack from your host (e.g., using `hydra`) against the monitored endpoint.
1. Show relevant alerts on the Wazuh dashboard and provide evidence that active response was triggered and attacker IP was blocked.
